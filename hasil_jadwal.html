<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hasil Jadwal Travel</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 15px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 500px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            font-size: 24px;
            margin-bottom: 20px;
        }
        .info-box {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .info-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        .info-label {
            font-weight: bold;
            color: #34495e;
        }
        .schedule-option {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            cursor: pointer;
        }
        .schedule-option.selected {
            border-color: #3498db;
            background-color: #f0f8ff;
        }
        .schedule-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        .schedule-time {
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
        }
        .schedule-price {
            color: #27ae60;
            font-weight: bold;
        }
        .vehicle-info {
            color: #7f8c8d;
            font-size: 14px;
            margin-bottom: 10px;
        }
        .seats-container {
            margin-top: 15px;
        }
        .seats-title {
            font-weight: bold;
            margin-bottom: 10px;
        }
        .seat-row {
            display: flex;
            justify-content: center;
            margin-bottom: 10px;
        }
        .seat {
            width: 30px;
            height: 30px;
            margin: 0 5px;
            background-color: #3498db;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            cursor: pointer;
        }
        .seat.selected {
            background-color: #e74c3c;
        }
        .seat.booked {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
        .driver-seat {
            background-color: #f39c12;
        }
        .summary {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        .total {
            font-weight: bold;
            font-size: 18px;
            color: #2c3e50;
        }
        .book-btn {
            background-color: #27ae60;
            color: white;
            border: none;
            padding: 12px;
            width: 100%;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 20px;
        }
        .book-btn:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Pilih Jadwal & Kursi</h1>
        
        <div class="info-box">
            <div class="info-row">
                <span class="info-label">Kota Asal:</span>
                <span id="origin-city">Denpasar</span>
            </div>
            <div class="info-row">
                <span class="info-label">Kota Tujuan:</span>
                <span id="destination-city">Surabaya</span>
            </div>
            <div class="info-row">
                <span class="info-label">Tanggal:</span>
                <span id="travel-date">15 Agustus 2025</span>
            </div>
            <div class="info-row">
                <span class="info-label">Penumpang:</span>
                <span id="passenger-count">2</span>
            </div>
        </div>

        <h2>Pilihan Jadwal</h2>
        
        <!-- Jadwal 1 -->
        <div class="schedule-option selected" data-schedule-id="1">
            <div class="schedule-header">
                <span class="schedule-time">07:00 - 12:00</span>
                <span class="schedule-price">Rp 150.000/kursi</span>
            </div>
            <div class="vehicle-info">
                <span>Travel: Sumber Kencono</span>
                <span> | </span>
                <span>Tipe: Toyota Hiace</span>
                <span> | </span>
                <span>Kursi tersedia: 5/12</span>
            </div>
            
            <div class="seats-container">
                <div class="seats-title">Pilih Kursi:</div>
                <div class="seat-row">
                    <div class="seat driver-seat" data-seat="A1">A1</div>
                    <div class="seat" data-seat="A2">A2</div>
                    <div class="seat" data-seat="A3">A3</div>
                </div>
                <div class="seat-row">
                    <div class="seat" data-seat="B1">B1</div>
                    <div class="seat" data-seat="B2">B2</div>
                    <div class="seat" data-seat="B3">B3</div>
                </div>
                <div class="seat-row">
                    <div class="seat booked" data-seat="C1">C1</div>
                    <div class="seat booked" data-seat="C2">C2</div>
                    <div class="seat" data-seat="C3">C3</div>
                </div>
                <div class="seat-row">
                    <div class="seat" data-seat="D1">D1</div>
                    <div class="seat" data-seat="D2">D2</div>
                    <div class="seat" data-seat="D3">D3</div>
                </div>
            </div>
        </div>
        
        <!-- Jadwal 2 -->
        <div class="schedule-option" data-schedule-id="2">
            <div class="schedule-header">
                <span class="schedule-time">10:00 - 15:00</span>
                <span class="schedule-price">Rp 175.000/kursi</span>
            </div>
            <div class="vehicle-info">
                <span>Travel: Laju Prima</span>
                <span> | </span>
                <span>Tipe: Isuzu Elf</span>
                <span> | </span>
                <span>Kursi tersedia: 8/14</span>
            </div>
            
            <div class="seats-container" style="display:none;">
                <div class="seats-title">Pilih Kursi:</div>
                <div class="seat-row">
                    <div class="seat driver-seat" data-seat="A1">A1</div>
                    <div class="seat" data-seat="A2">A2</div>
                    <div class="seat" data-seat="A3">A3</div>
                    <div class="seat" data-seat="A4">A4</div>
                </div>
                <div class="seat-row">
                    <div class="seat" data-seat="B1">B1</div>
                    <div class="seat" data-seat="B2">B2</div>
                    <div class="seat" data-seat="B3">B3</div>
                    <div class="seat" data-seat="B4">B4</div>
                </div>
                <div class="seat-row">
                    <div class="seat booked" data-seat="C1">C1</div>
                    <div class="seat booked" data-seat="C2">C2</div>
                    <div class="seat" data-seat="C3">C3</div>
                    <div class="seat" data-seat="C4">C4</div>
                </div>
                <div class="seat-row">
                    <div class="seat" data-seat="D1">D1</div>
                    <div class="seat" data-seat="D2">D2</div>
                    <div class="seat" data-seat="D3">D3</div>
                    <div class="seat" data-seat="D4">D4</div>
                </div>
            </div>
        </div>
        
        <div class="summary">
            <div class="summary-row">
                <span>Jadwal:</span>
                <span id="selected-schedule">07:00 - 12:00</span>
            </div>
            <div class="summary-row">
                <span>Kursi terpilih:</span>
                <span id="selected-seats">-</span>
            </div>
            <div class="summary-row total">
                <span>Total:</span>
                <span id="total-price">Rp 0</span>
            </div>
        </div>
        
        <button class="book-btn" id="book-btn" disabled>Lanjut ke Pembayaran</button>
    </div>

    <script>
        // Ambil parameter dari URL
        const urlParams = new URLSearchParams(window.location.search);
        document.getElementById('origin-city').textContent = formatCityName(urlParams.get('kota-asal'));
        document.getElementById('destination-city').textContent = formatCityName(urlParams.get('kota-tujuan'));
        document.getElementById('travel-date').textContent = formatDate(urlParams.get('tanggal'));
        document.getElementById('passenger-count').textContent = urlParams.get('penumpang');
        
        // Format nama kota
        function formatCityName(city) {
            if (!city) return '-';
            return city.charAt(0).toUpperCase() + city.slice(1);
        }
        
        // Format tanggal
        function formatDate(dateString) {
            if (!dateString) return '-';
            const options = { day: 'numeric', month: 'long', year: 'numeric' };
            return new Date(dateString).toLocaleDateString('id-ID', options);
        }
        
        // Variabel untuk menyimpan data pemesanan
        let selectedSchedule = null;
        let selectedSeats = [];
        const passengerCount = parseInt(urlParams.get('penumpang') || '1');
        const pricePerSeat = 150000; // Ini bisa diambil dari data jadwal
        
        // Pilih jadwal
        document.querySelectorAll('.schedule-option').forEach(option => {
            option.addEventListener('click', function() {
                // Sembunyikan semua seat container terlebih dahulu
                document.querySelectorAll('.seats-container').forEach(container => {
                    container.style.display = 'none';
                });
                
                // Hapus selected class dari semua option
                document.querySelectorAll('.schedule-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                
                // Tambahkan selected class ke option yang dipilih
                this.classList.add('selected');
                
                // Tampilkan seat container untuk option yang dipilih
                const seatsContainer = this.querySelector('.seats-container');
                if (seatsContainer) {
                    seatsContainer.style.display = 'block';
                }
                
                // Simpan jadwal yang dipilih
                selectedSchedule = this.dataset.scheduleId;
                document.getElementById('selected-schedule').textContent = 
                    this.querySelector('.schedule-time').textContent;
                
                // Reset kursi terpilih saat ganti jadwal
                selectedSeats = [];
                updateSelectedSeats();
                updateBookButton();
            });
        });
        
        // Pilih kursi
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('seat') && 
                !e.target.classList.contains('booked') && 
                !e.target.classList.contains('driver-seat')) {
                
                const seat = e.target.dataset.seat;
                const index = selectedSeats.indexOf(seat);
                
                if (index === -1) {
                    // Jika kursi belum dipilih dan belum mencapai max penumpang
                    if (selectedSeats.length < passengerCount) {
                        e.target.classList.add('selected');
                        selectedSeats.push(seat);
                    }
                } else {
                    // Jika kursi sudah dipilih, hapus dari pilihan
                    e.target.classList.remove('selected');
                    selectedSeats.splice(index, 1);
                }
                
                updateSelectedSeats();
                updateBookButton();
            }
        });
        
        // Update tampilan kursi terpilih
        function updateSelectedSeats() {
            const seatsElement = document.getElementById('selected-seats');
            if (selectedSeats.length > 0) {
                seatsElement.textContent = selectedSeats.join(', ');
                document.getElementById('total-price').textContent = 
                    'Rp ' + (selectedSeats.length * pricePerSeat).toLocaleString('id-ID');
            } else {
                seatsElement.textContent = '-';
                document.getElementById('total-price').textContent = 'Rp 0';
            }
        }
        
        // Update status tombol pesan
        function updateBookButton() {
            const bookBtn = document.getElementById('book-btn');
            if (selectedSchedule && selectedSeats.length === passengerCount) {
                bookBtn.disabled = false;
            } else {
                bookBtn.disabled = true;
            }
        }
        
        // Proses pemesanan
        document.getElementById('book-btn').addEventListener('click', function() {
            // Simpan data pemesanan ke localStorage atau kirim ke server
            const bookingData = {
                origin: urlParams.get('kota-asal'),
                destination: urlParams.get('kota-tujuan'),
                date: urlParams.get('tanggal'),
                scheduleId: selectedSchedule,
                scheduleTime: document.getElementById('selected-schedule').textContent,
                seats: selectedSeats,
                totalPrice: selectedSeats.length * pricePerSeat,
                passengerCount: passengerCount
            };
            
            localStorage.setItem('currentBooking', JSON.stringify(bookingData));
            
            // Redirect ke halaman pembayaran
            window.location.href = 'pembayaran.html';
        });
        
        // Pilih jadwal pertama secara default
        document.querySelector('.schedule-option').click();
    </script>
</body>
</html>
